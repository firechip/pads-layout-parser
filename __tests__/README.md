# Test Suite for `pads-layout-parser`

This directory contains the test suite for the `pads-layout-parser` library. We are using [Jest](https://jestjs.io/) as the testing framework.

## Test Structure

The tests are organized into two main categories:

*   **`valid/`:** Contains valid PADS netlist files (`.pads`) that are expected to be parsed successfully without any errors.
*   **`invalid/`:** Contains invalid PADS netlist files (`.pads`) that are expected to throw specific errors during parsing.

Each test file within these directories corresponds to a specific test case or scenario.

## Test Cases

The test suite covers a wide range of scenarios, including:

### Valid PADS Files

*   **Basic Parsing:** Parsing of a simple, valid PADS netlist.
*   **Empty Sections:** Parsing of files with empty `*PART*` or `*NET*` sections.
*   **Multiple Nets:** Parsing of files with multiple nets, including nets with only one connection.
*   **Different Pin Formats:** Parsing of nets with different valid pin formats.
*   **Values in `*PART*` Section:** Parsing of files where parts have values associated with them.
*   **Long Names:** Parsing of files with part reference designators and net names close to the maximum allowed length.
*   **Comments:** Correct handling of comment lines in the PADS file.
*   **Case Sensitivity:** Check if the parser handle properly net names, part names, pin names and keywords in a case sensitive or insensitive way.
*   **Different Order of Sections:** Parsing of files where `*PART*` and `*NET*` sections are in different orders.

### Invalid PADS Files

*   **Missing Header:** Files missing the `*PADS-PCB*` or `*PADS2000*` header.
*   **Missing Sections:** Files missing `*PART*` or `*NET*` sections.
*   **Invalid Section Headers:** Files with incorrect section headers.
*   **Invalid Part Format:** Files with lines in the `*PART*` section that don't follow the expected format.
*   **Duplicate Parts:** Files containing duplicate part reference designators.
*   **Part Refdes Too Long:** Files with part reference designators exceeding the maximum length.
*   **Invalid Part Refdes:** Files with part reference designators containing invalid characters.
*   **Footprint Name Too Long:** Files with footprint names exceeding the maximum length.
*   **Invalid Net Format:** Files with lines in the `*NET*` section that don't follow the expected format.
*   **Duplicate Net Names:** Files containing duplicate net names.
*   **Net Name Too Long:** Files with net names exceeding the maximum length.
*   **Invalid Net Name:** Files with net names containing invalid characters.
*   **Invalid Pin Format:** Files with lines in the `*SIGNAL*` section that have invalid pin formats.
*   **Duplicate Pins:** Files with nets containing the same pin connection multiple times.
*   **Pin Refdes Too Long:** Files with pin reference designators exceeding the maximum length.
*   **Pin Name Too Long:** Files with pin names exceeding the maximum length.
*   **Unexpected EOF:** Files that end prematurely.
*   **Unexpected Token:** Files with unexpected keywords or characters.
*   **Inconsistent number of pins**: Files where a net has a different number of pins in different parts of the file.

### Edge Cases

*   **Empty File:** An empty PADS file.
*   **File with Only Header:** A file containing only the `*PADS-PCB*` header.
*   **File with Only Comments:** A file containing only comments.
*   **Maximum Length Names:** Files with part refdes, net names, and pin names at the maximum allowed length.

## Running Tests

To run the tests, use the following command from the root directory of the `pads-layout-parser` package:

```bash
npm test
```

## Adding New Tests

1.  Create a new `.pads` file in the appropriate directory (`valid` or `invalid`).
2.  Write the corresponding test case in `PADSParser.test.ts`, following the existing examples.
3.  If adding an invalid test case, make sure to specify the expected error code and line number using `toThrowError` and `ParserError`.

## Test File Naming Conventions

*   Use descriptive filenames that clearly indicate the purpose of the test case.
*   For invalid files, prefix the filename with `invalid_` and include a brief description of the error being tested (e.g., `invalid_missing_header.pads`, `invalid_duplicate_part.pads`).

## Code Coverage

Code coverage reports can be generated by running:

```bash
npm test -- --coverage
```

This will provide information about which parts of the code are covered by the tests and highlight any areas that need further testing.

## Contributing

If you find any bugs or want to add new test cases, please feel free to submit a pull request.

